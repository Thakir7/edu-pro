<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>سجل الحضور</title>

  <link rel="stylesheet" href="assets/style.css">
  <script src="assets/config.js"></script>
  <script src="assets/app.js"></script>
</head>
<body>

<h2 id="pageTitle">سجل الحضور</h2>

<div id="tableBox"></div>

<script>
(function(){
  const params = new URLSearchParams(window.location.search);
  const group = params.get("group");

  if (!group) {
    document.getElementById("tableBox").innerHTML =
      "<div class='alert'>لم يتم تحديد رقم الشعبة</div>";
    return;
  }
const params = new URLSearchParams(location.search);
let group = params.get("group");

// ✅ لو ما فيه group بالرابط، خذه من جلسة المتدرب
if (!group) {
  try {
    const s = JSON.parse(localStorage.edu_session || "{}");
    group = s.group || s.traineeGroup || "";
  } catch(e){}
}

  document.getElementById("pageTitle").textContent =
    "سجل الحضور – شعبة " + group;

  fetch(window.API_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({
      action:"coach_getAttendance",
      group: group
    })
  })
  .then(r=>r.json())
  .then(res=>{
    renderSheetTable("tableBox", res);
  });
})();
</script>

</body>
</html>
